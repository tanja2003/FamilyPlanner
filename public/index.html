<!DOCTYPE html>
<html>
<head>
    <title>Homeoffice Planer</title>
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>
</head>
<body>
    <h1>Homeoffice Planer</h1>


    <input id="user" placeholder="Name">
    <input type="date" id="date">
    <select id="status">
        <option value="Homeoffice">Homeoffice</option>
        <option value="Büro">Büro</option>
    </select>
    <button onclick="addEntry()">Eintragen</button>

    <ul id="entries"></ul>
    <div id="calendar"></div>
    <style>
        #calendar {
            max-width: 900px;
            margin: 40px auto;
        }
        </style>

    <script>
        async function addEntry() {
            const user = document.getElementById('user').value;
            const date = document.getElementById('date').value;
            const status = document.getElementById('status').value;

            await fetch('http://localhost:3000/homeoffice', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ user, date, status })
            });

            loadEntries();
        }

        async function loadEntries() {
            const res = await fetch('http://localhost:3000/homeoffice');
            const data = await res.json();
            const list = document.getElementById('entries');
            list.innerHTML = '';
            data.forEach(e => {
                const li = document.createElement('li');
                li.textContent = `${e.user} - ${e.date} - ${e.status}`;
                list.appendChild(li);
            });
        }

        async function deleteEntry(id) {
            const res = await fetch(`http://localhost:300/homeoffice/${id}`, {
                method: "DELETE"
            });
            const data = await res.json();
            const list = document.getElementById('entries');
            list.innerHTML = '';
            data.forEach(e => {
                const li = document.createElement('li');
                li.textContent = `${e.user} - ${e.date} - ${e.status}`;
                list.appendChild(li);
            });
            
        }
        loadEntries();

        document.addEventListener('DOMContentLoaded', async function () {
  const calendarEl = document.getElementById('calendar');

  const res = await fetch('/homeoffice');
  const data = await res.json();

  const events = data.map(e => ({
    title: `${e.user} – ${e.status}`,
    start: e.date,
    allDay: true,
    color: e.status === 'Homeoffice' ? '#4CAF50' : '#2196F3'
  }));

  const calendar = new FullCalendar.Calendar(calendarEl, {
    initialView: 'dayGridMonth',
    locale: 'de',
    events: events
  });

  calendar.render();
});
    </script>
</body>
</html>
